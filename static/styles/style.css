/* RTL Arabic minimalist theme */
:root {
  /* Light Theme (Default) */
  --bg: #f9fafb;
  --card: #ffffff;
  --text: #111827;
  --muted: #6b7280;
  --brand: #0e7490; /* Darker cyan for contrast */
  --ghost: #f3f4f6;
  --border: #e5e7eb;
  --brand-light: #cffafe;
  --brand-glow: 0 0 8px rgba(14, 116, 144, 0.2);
  --btn-text: #ffffff; /* White text for dark brand color */
  --icon-filter: invert(11%) sepia(15%) saturate(2837%) hue-rotate(151deg) brightness(94%) contrast(94%); /* for #111827 */
}

[data-theme="dark"] {
  --bg: #0a0a14;
  --card: #111827;
  --text: #e5e7eb;
  --brand: #22d3ee;
  --ghost: #1f2937;
  --border: #1f2937;
  --brand-light: #392f6b;
  --brand-glow: 0 0 8px rgba(34, 211, 238, 0.4);
  --btn-text: #0a0a14; /* Dark text for light brand color */
  --icon-filter: invert(91%) sepia(4%) saturate(265%) hue-rotate(193deg) brightness(93%) contrast(91%); /* for #e5e7eb */
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:transparent;color:var(--text);font-family:system-ui,Segoe UI,Roboto,Arial}
.container{max-width:980px;margin:auto;padding:16px}
.topbar{border-bottom:1px solid var(--border);position:sticky;top:0;background:var(--bg);z-index:5}
.brand{margin:0;font-size:1.25rem}
.topbar .container{display:flex;align-items:center;justify-content:space-between}
.brand-link {
  text-decoration: none;
  color: inherit;
}
.main-nav{display:flex;align-items:center;gap:4px}
.main-nav a{color:var(--text);text-decoration:none;margin-inline:6px;padding:6px 10px;border-radius:10px}
.main-nav a:hover{background:var(--ghost)}
.card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:16px;margin:14px 0}
.btn{background:var(--brand);color:var(--btn-text);border:none;border-radius:12px;padding:10px 14px;cursor:pointer;text-decoration:none;display:inline-block;font-weight:bold;transition:all .2s ease}
.btn:hover{opacity:.95}
.btn-ghost{background:var(--ghost);color:var(--text)}
.form label{display:block;margin:8px 0}
.btn-icon{width:50px;height:50px;padding:10px;flex-shrink:0}
.btn-icon img {
  width: 100%;
  height: 100%;
  filter: var(--icon-filter);
}

.form input,.form textarea,.form select{width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:var(--bg);color:var(--text)}
.form input:focus, .form textarea:focus, .form select:focus{outline:none;border-color:var(--brand);box-shadow:var(--brand-glow)}
.form.inline{display:flex;gap:8px;align-items:center}
.error{background:#3b0d0d;color:#fdd;padding:10px;border-radius:10px;margin:8px 0}
.flash{margin-top:12px}
.flash-item{background:#0b3b20;border:1px solid #0f6a3a;color:#dfd;padding:8px;border-radius:8px;margin:6px 0}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.secondary-forms{grid-template-columns:1fr 1fr}
@media(max-width:900px){.grid,.secondary-forms{grid-template-columns:1fr}}
.table{width:100%;border-collapse:collapse}
.table th,.table td{border-top:1px solid var(--border);padding:10px;vertical-align:top}
.table .wrap{white-space:pre-wrap;line-height:1.6}
.muted{color:var(--muted)}

/* AI Chat Interface Styles */
.chat-container{padding:0;display:flex;flex-direction:column;height:85vh;max-height:900px}
.chat-header{font-size:1.1rem;padding:12px 16px;margin:0;border-bottom:1px solid var(--border)}
.chat-history{flex-grow:1;display:flex;flex-direction:column;gap:14px;overflow-y:auto;padding:16px;background:var(--bg)}
.msg-wrapper{display:flex;flex-direction:column}
.msg-wrapper.current-user{align-items:flex-end}
.msg-wrapper.current-user .bubble{background:var(--brand-light);border-color:var(--brand);border-radius:18px 18px 4px 18px;box-shadow:var(--brand-glow)}
.msg-wrapper.current-user .meta{text-align:end}
.msg .meta{font-size:.8rem;color:var(--muted)}
.bubble{background:var(--ghost);border:1px solid var(--border);padding:10px 14px;border-radius:18px 18px 18px 4px;margin-top:4px;max-width:75%}
.chat-form{border-top:1px solid var(--border);padding:12px 16px}
.chat-inputs{display:flex;gap:8px;align-items:center}
.chat-inputs{background:var(--ghost);border:1px solid var(--border);border-radius:14px;padding:4px 4px 4px 12px}
.chat-inputs:focus-within{border-color:var(--brand);box-shadow:var(--brand-glow)}
.chat-inputs input{flex-grow:1;background:transparent;border:none;outline:none;color:var(--text);font-size:1rem}
.send-btn{flex-shrink:0;width:38px;height:38px;padding:0;display:flex;align-items:center;justify-content:center;border-radius:10px}
.send-btn svg{stroke: #0a0a14;}
.send-btn:hover{background:#38e6ff;}

/* Hero centered input (matches provided RTL mock) */
.hero{padding:48px 16px 28px;text-align:center}
.hero-title{font-size:2.25rem;margin:8px 0 18px;font-weight:600}
.hero-card{max-width:820px;margin:0 auto;border-radius:32px;padding:18px 20px}
.hero-form{display:flex;align-items:center;justify-content:center;gap:8px}
.hero-input{display:flex;align-items:center;gap:12px;background:var(--card);border-radius:40px;padding:14px 16px;border:1px solid var(--border);width:100%;box-shadow:var(--brand-glow);color:var(--text)}
.hero-input .hero-placeholder{flex:1;text-align:start;color:var(--muted);font-size:1.05rem;padding-inline-start:8px}
.chips{display:flex;gap:8px;align-items:center}
.chip{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text);padding:6px 10px;border-radius:999px;font-size:.95rem;cursor:pointer}
.chip:hover{background:rgba(255,255,255,0.02)}
.input-actions{display:flex;align-items:center;gap:8px}
.voice-btn{background:transparent;border-radius:999px;padding:10px 14px;border:1px solid rgba(255,255,255,0.06);color:var(--text);font-weight:700}
.voice-label{display:inline-block;padding-inline:6px}

/* Make hero input pill responsive */
@media(max-width:680px){
  .hero-title{font-size:1.6rem}
  .hero-card{padding:12px}
  .hero-input{flex-direction:column;align-items:stretch;padding:12px;gap:10px}
  .hero-input .hero-placeholder{text-align:center}
  .chips{justify-content:center}
}

/* New Nav Styles */
.nav-icon{background:transparent;border:none;cursor:pointer;padding:8px;border-radius:50%;display:flex;align-items:center;justify-content:center}
.nav-icon:hover{background:var(--ghost)}
.nav-icon img{width:24px;height:24px}
/* Apply theme-aware filter to all nav icons */
.nav-icon img { filter: var(--icon-filter); }
/* Specific adjustment for light icon to visually match others */
#theme-icon-light {
  transform: scale(1.5);
}

.user-menu{position:relative}
.user-menu-dropdown{
  display:none; /* Hidden by default */
  position:absolute;
  left:0;
  top:calc(100% + 8px);
  background:var(--card);
  border:1px solid var(--border);
  border-radius:12px;
  min-width:180px;
  z-index:10;
  padding:6px;
  box-shadow:0 4px 12px rgba(0,0,0,0.2);
}
.user-menu-dropdown a{display:block;width:100%;text-align:right;margin:0;padding:8px 12px}
.user-menu-dropdown .divider{height:1px;background:var(--border);margin:6px 0}
.user-menu-dropdown.show{display:block}

/* Submission Detail Page Styles */
.grades-display {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}
.grade-item h4 { margin-top: 0; }

.flash-prompt {
  background: var(--brand-light);
  border: 1px solid var(--brand);
  color: var(--text); /* Ensure text color is readable */
  padding: 12px 16px;
  border-radius: 12px;
  margin-bottom: 20px;
  text-align: center;
}
.flash-prompt h3 {
  margin-top: 0;
  margin-bottom: 10px;
  color: var(--text); /* Ensure text color is readable */
}
.flash-prompt .form.inline {
  justify-content: center;
  gap: 10px;
}

/* Submission Detail Page Styles */
.grades-display {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}
.grade-item h4 { margin-top: 0; }

/* Confirmation Modal Styles */
.modal-overlay {
  display: none; /* Hidden by default */
  position: fixed;
  z-index: 100;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.6);
  align-items: center;
  justify-content: center;
}
.modal-content {
  position: relative;
  margin: auto;
  padding: 20px;
  width: 90%;
  max-width: 500px;
  text-align: center;
}
.modal-close {
  position: absolute;
  top: 10px;
  left: 20px; /* RTL support */
  color: var(--muted);
  font-size: 28px;
  font-weight: bold;
  border: none;
  background: none;
  cursor: pointer;
}
.modal-text-preview {
  background: var(--ghost);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 10px;
  margin: 16px 0;
  max-height: 150px;
  overflow-y: auto;
  text-align: right;
  white-space: pre-wrap;
}
.modal-actions {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-top: 20px;
}
.grade-item h4 { margin-top: 0; }

/* Rubric Table Styles */
.rubric-table {
  width: 100%;
  border-collapse: collapse;
  margin: 20px 0;
}
.rubric-table th, .rubric-table td {
  border: 1px solid var(--border);
  padding: 8px;
  text-align: center;
  vertical-align: middle;
}
.rubric-table th {
  background: var(--ghost);
}
.rubric-table .criterion {
  text-align: right;
  background: var(--ghost);
  font-weight: bold;
}
.form-section { margin-top: 16px; }
.auth {
  max-width: 450px;
  margin-left: auto;
  margin-right: auto;
}
.rubric-display {
  margin-top: 20px;
  border-top: 1px solid var(--border);
  padding-top: 16px;
}
.rubric-display h5 {
  margin-top: 0;
}
.rubric-table .comment-cell {
  text-align: right;
}

/* === Full-page Islamic geometric background (canvas) === */
.bg-canvas-wrap{
  position: fixed;
  inset: 0;
  z-index: 0;
  pointer-events: none;
}
#bg-canvas{ width:100%; height:100%; display:block }

/* اجعل المحتوى فوق الخلفية */
.topbar, .container, .card, .auth, form { position: relative; z-index: 1; }

/* ألوان الخط/الخلفية تعتمد على الثيم */
:root{
  --geo-line: #b08a4a; /* ذهبي فاتح */
}
[data-theme="dark"]{
  --geo-line: #b08a4a; /* يبقى ذهبي */
}

/* تقليل الحركة */
@media (prefers-reduced-motion: reduce){
  #bg-canvas{ opacity: .85; }
}

/* Temporary debug styles for canvas */
.bg-canvas-wrap {
  border: 2px dashed red; /* Debug: visually confirm wrapper bounds */
}
#bg-canvas {
  border: 2px solid blue; /* Debug: visually confirm canvas bounds */
}
